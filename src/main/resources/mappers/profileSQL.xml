<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.profile.ProfileMapper">
	<!-- 내가 만든 리스트 전체 -->
	<select id="getCreativeProject" parameterType="String" resultType="pdto">
		SELECT * FROM project WHERE name=#{name} ORDER BY idx desc
	</select>
	<!-- idx 에 대한 프로젝트 데이터 반환 -->
	<select id="getProject" parameterType="String" resultType="pdto">
		SELECT * FROM project WHERE idx=#{idx}
	</select>
	<!-- creative project delete -->
	<delete id="deleteCreativeProject" parameterType="String">
		DELETE FROM project WHERE idx=#{idx}
	</delete>
	<!-- 후원한 프로젝트 리스트 -->
	<select id="getSupportProject" parameterType="String" resultType="sdetaildto">
		SELECT s.*, p.title, p.thumbnail, p.category, p.name, p.total_amount FROM support AS s JOIN project AS p ON s.idx=p.idx WHERE s.id=#{s.id} ORDER BY num desc
	</select>
	<!-- 후원한 프로젝트 데이터 반환 -->
	<select id="getSupportData" parameterType="String" resultType="sdetaildto">
		SELECT s.*, p.title, p.thumbnail, p.category, p.name, p.total_amount FROM support AS s JOIN project AS p ON s.idx=p.idx WHERE s.num=#{s.num}
	</select>
	<!-- 후원한 프로젝트 취소(삭제) -->
	<delete id="deleteSupport" parameterType="String">
		DELETE FROM support WHERE num=#{num}
	</delete>
	<!-- 찜한 프로젝트 리스트 -->
	<select id="getLikedProject" parameterType="String" resultType="ldto">
		SELECT l.*, p.title, p.thumbnail, p.category, p.name, p.start_date, p.end_date, p.total_amount FROM liked AS l JOIN project AS p ON l.idx=p.idx WHERE l.id=#{l.id} ORDER BY num desc
	</select>
	<!-- 찜한 프로젝트 삭제 -->
	<delete id="deleteLikedProject" parameterType="String">
		DELETE FROM liked WHERE num=#{num}
	</delete>
	
	<select id="getCreativeAuditCount" parameterType="String">
		SELECT count(*) FROM project WHERE name=${name} AND audit=#{audit}
	</select>
	
	
</mapper>